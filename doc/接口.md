## 接口API

### 目前服务器地址：http://116.62.244.93:8089/


登录服务器    app_zhuanquan/Qwer1234

日志目录:  /home/zhuanquan/apache-tomcat-7.0.77/logs

短信验证码查看: tail -100f /home/zhuanquan/apache-tomcat-7.0.77/logs/catalina.out





### 所有接口统一返回ApiResponse对象，json格式为：
```json
{
  "data": "json data",
  "code": 1000,
  "message": "",
  "success": true
}
```

### data： 表示实际返回数据的json格式
### code： 1000表示操作成功，反之，表示具体的失败的异常码
### message：详细的错误描述信息
### success：操作成功还是失败

#### 失败的返回示例:
```json
{
  "code": 100001001,
  "message": "[code:100001001,message:null]",
  "success": false
}
```

#### 成功的返回示例:
```json
{
  "data": "xxx",
  "code": 1000,
  "message": "",
  "success": true
}
```


code定义

https://github.com/zhuanq/WEB/blob/master/app_zhuanquan/server/src/main/resources/META-INF/errorcode/service-error-all.yml


--------- 
### 1.登录注册模块

##### 1）  发送注册短信

###### 请求url:
http://116.62.244.93:8089/register/sendRegSms.json
###### 参数:
mobile 手机号 

##### 接口示例：

http://116.62.244.93:8089/register/sendRegSms.json?mobile=18061661296

##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```

##### 2）  手机注册
  
###### 请求url:
http://116.62.244.93:8089/register/registerByMobile.json
###### 参数:
mobile 手机号 

password 密码

verifyCode 短信验证码

##### 接口示例：

http://116.62.244.93:8089/register/registerByMobile.json?mobile=18061661297&password=123456abc&verifyCode=178651

##### 接口返回:
```json
{
  "data": {
    "uid": 1,
    "sessionId": "xasdadadassdsadasdasdasd"
  },
  "code": 1000,
  "message": "",
  "success": true
}
```

##### 3）  sesion检查，app唤醒时检查会话状态
  
###### 请求url:
http://116.62.244.93:8089/login/sessionCheck.json
###### 参数:

无

##### 接口示例：

http://116.62.244.93:8089/login/sessionCheck.json


##### 接口返回:
```json
{
  "data": {
    "allowAttation": 1,
    "channelType": 0,
    "headUrl": "",
    "isVip": 0,
    "nickName": "7f63af11-f3f2-4a26-89da-d5471fcae725",
    "openId": "18061661297",
    "regStat": 0,
    "uid": 1006,
    "sessionId": "xasdadadassdsadasdasdasd"
    
  },
  "code": 1000,
  "message": "",
  "success": true
}
```

返回参数说明

regStat   0-vip用户协议页面 1-设置昵称页面 2-设置圈子页面 3-设置关注作者页面 4-注册完成


##### 4）  手机/密码登录
  
###### 请求url:
http://116.62.244.93:8089/login/loginByMobile.json
###### 参数:

userName 手机号 

password 密码

verifyCode 验证码(可能没有，输错几次密码之后才会有)

##### 接口示例：

http://116.62.244.93:8089/login/loginByMobile.json?userName=18061661297&password=123456abc

##### 接口返回:
```json
{
  "data": {
    "allowAttation": 1,
    "channelType": 0,
    "headUrl": "",
    "isVip": 0,
    "nickName": "7f63af11-f3f2-4a26-89da-d5471fcae725",
    "openId": "18061661297",
    "regStat": 0,
    "uid": 1006,
    "sessionId": "xasdadadassdsadasdasdasd"
    
  },
  "code": 1000,
  "message": "",
  "success": true
}
```

返回参数说明

regStat   0-vip用户协议页面 1-设置昵称页面 2-设置圈子页面 3-设置关注作者页面 4-注册完成


##### 5） 微博登录
  
###### 请求url:
http://116.62.244.93:8089/login/loginByOpenId.json
###### 参数:
openId: 第三方登录的openid，比如微博的uid 

token: token信息

channelType:  频道类型  1-微博

##### 接口示例：

http://116.62.244.93:8089/login/loginByOpenId.json?openId=123123123&token=123456abc&channelType=1

##### 接口返回:
```json
{
  "data": {
    "allowAttation": 1,
    "channelType": 0,
    "headUrl": "",
    "isVip": 0,
    "nickName": "7f63af11-f3f2-4a26-89da-d5471fcae725",
    "openId": "18061661297",
    "regStat": 0,
    "uid": 1006,
    "sessionId": "xasdadadassdsadasdasdasd"
  },
  "code": 1000,
  "message": "",
  "success": true
}
```
返回参数说明

regStat   0-vip用户协议页面 1-设置昵称页面 2-设置圈子页面 3-设置关注作者页面 4-注册完成



##### 6）  设置昵称和性别
  
###### 请求url:
http://116.62.244.93:8089/register/setNickNameAndGenderOnRegister.json
###### 参数:
uid uid 

nickName 昵称

gender 性别 0-男 1-女

##### 接口示例：

http://116.62.244.93:8089/register/setNickNameAndGenderOnRegister.json?uid=1000&nickName=2345&gender=1

##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```


##### 7）  推荐的标签
  
###### 请求url:
http://116.62.244.93:8089/tag/getSuggestTags.json
###### 参数:
uid  uid

fromIndex 从哪条开始查

limit 一次查多少条

##### 接口示例：

http://116.62.244.93:8089/tag/getSuggestTags.json?uid=1000&fromIndex=0&limit=2


##### 接口返回:
```json
{
  "data": [
    {
      "tagId": 1,
      "tagName": "游戏1",
      "tagType": 0
    },
    {
      "tagId": 17,
      "tagName": "音乐7",
      "tagType": 0
    }
  ],
  "code": 1000,
  "message": "",
  "success": true
}
```


##### 接口返回data 参数说明:

tagId tag的id

tagName tag名

tagType  tag类型

isDefaultFollowed 是否默认关注，第三方同步过来的关注列表里的默认关注 ，0-不关注 1-关注



##### 8）  注册设置关注的标签
  
###### 请求url:
http://116.62.244.93:8089/register/setFollowTagsOnRegister.json



###### 参数:

uid  用户id
tagIdsStr tag id list的json格式，比如[1,2,3]

##### 接口示例：

http://116.62.244.93:8089/register/setFollowTagsOnRegister.json

参数
uid=1000&tagIdsStr=[1,2,3]


##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```



##### 9）  获取推荐的作者
  
###### 请求url:
http://116.62.244.93:8089/author/getSuggestAuthors.json

###### 方法:

###### 参数:
uid  uid

fromIndex  从第几个开始

limit 总共几个


##### 接口示例：

http://116.62.244.93:8089/author/getSuggestAuthors.json?uid=1000&fromIndex=0&limit=10



##### 接口返回:
```json
{
  "data": {
    "page": 1,
    "uid": 1000,
    "suggestAuthors": [
      {
        "authorId": 1,
        "authorName": "author:1",
        "headUrl": "http://avsadasda.gif",
        "isDefaultFollow": 1
      },
      {
        "authorId": 2,
        "authorName": "author:2",
        "headUrl": "http://avsadasda.gif",
        "isDefaultFollow": 1
      }
    ]
  },
  "code": 1000,
  "message": "",
  "success": true
}
```



##### 10）  注册设置关注的作者
  
###### 请求url:
http://116.62.244.93:8089/register/setFollowTagsOnRegister.json


###### 参数:

uid  用户id

authorIdsStr 关注的author ids list的json字符串，比如[111,222]

##### 接口示例：

http://116.62.244.93:8089/register/setFollowAuthorsOnRegister.json

参数

uid=1001&authorIdsStr=[111,222]

##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```




--------- 
### 2.关注，点赞

##### 1）  关注作者

###### 请求url:

http://116.62.244.93:8089/follow/followAuthor.json###### 参数:
uid uid 
authorId 作者id

##### 接口示例：

http://116.62.244.93:8089/follow/followAuthor.json?uid=1001&authorId=1


##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```



##### 2）  取消关注

###### 请求url:

http://116.62.244.93:8089/follow/cancelFollowAuthor.json

###### 参数:
uid uid 
authorId 作者id
##### 接口示例：

http://116.62.244.93:8089/follow/cancelFollowAuthor.json?uid=1001&authorId=1


##### 接口返回:
```json
{
  "data": null,
  "code": 1000,
  "message": "",
  "success": true
}
```


##### 3）  查询关注的作者信息

###### 请求url:

http://116.62.244.93:8089/follow/queryUserFollowAuthors.json

###### 参数:
uid uid 

##### 接口示例：

http://116.62.244.93:8089/follow/queryUserFollowAuthors.json?uid=1001


##### 接口返回:
```json
{
  "code": 1000,
  "data": {
    "followAuthors": [
      {
        "authorId": 2,
        "authorName": "作者2",
        "headUrl": "http://www.test.xxx/2.jpg",
        "tagDesc": "歌手",
        "tagIds": "100002"
      },
      {
        "authorId": 1,
        "authorName": "张三丰",
        "headUrl": "http://www.test.xxx/1.jpg",
        "tagDesc": "武侠,古风",
        "tagIds": "112,111"
      },
      {
        "authorId": 5,
        "authorName": "作者5",
        "headUrl": "http://www.test.xxx/1.jpg",
        "tagDesc": "作家,歌手,漫画家",
        "tagIds": "100001,100002,100003"
      }
    ],
    "uid": 1001
  },
  "message": "",
  "success": true
}
```
